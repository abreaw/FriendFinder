<!DOCTYPE html>
<html>
<head>
	<title>Friend Finder</title>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

	<!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous"> -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    
	<style type="text/css">

		.jumbotron {
			text-align: center;
		}

		.question-border{
			border: solid 1px #D3D3D3;
			padding: 4px 16px;
			border-radius: 5px;
		}

		.question-text{
			font-size: large;
		}

		.radio-label-text{
			font-size: x-large;
		}

		.alternate-row-highlight{
			background-color: #D6F6FE;
		}

		.add-left-padding{
			padding-left: 16px;
		}

		.error-display{
			background-color: #FDE3E6;
			border: solid 2px #FE8D9C;
		}


	</style>

</head>
<body>

	<div class="container">

		<div class="jumbotron">
			<h1>Meet a Friend</h1>
			<!-- <img src="https://blog.lareviewofbooks.org/wp-content/uploads/2017/01/AFAF.jpg" class="img" alt="asking for a friend" style="width:50%;height:50%;"> -->
			<img src="https://cdn.pixabay.com/photo/2016/12/20/22/33/family-1921664_960_720.png" class="img" alt="friends chain" style="width:50%;height:50%;">
		</div>

		<div class="panel-group">

		    <div class="panel panel-info">
				<div class="panel-heading">Complete the following questions to find your compatible friend.</div>
				<div class="panel-body text-info">
					<form>
						<div class="form-group">
						    <label class="question-text" for="name-input">Your Name:</label>
						    <input type="text" class="form-control" id="name-input" placeholder="ex. John Smith">
						</div>
						<div class="form-group">
						    <label class="question-text" for="profile-img-link">Profile Image Link:</label>
						    <input type="url" class="form-control" id="profile-img-link" placeholder="ex. https://i.imgur.com/t0MRiAf.png">
						</div>
<!-- 						<div class="form-group">
							<label class="question-text" for="exampleFormControlSelect1">You are quick to make decisions.</label>
							<select class="form-control" id="exampleFormControlSelect1" placeholder="Select an Option">
								<option>1 (Strongly Disagree)</option>
								<option>2</option>
								<option>3</option>
								<option>4</option>
								<option>5 (Strongly Agree)</option>
							</select>
						</div> -->
						<div class="form-group question-border question-text alternate-row-highlight">
							<label class="text-info">You are quick to make decisions.</label>
							<div class="form-check form-check-inline radio-label-text">
								<span class="question-text">Strongly Disagree ... </span>
								<input class="form-check-input" type="radio" name="quest1" value="1"> 1 
								<input class="form-check-input" type="radio" name="quest1" value="2"> 2 
								<input class="form-check-input" type="radio" name="quest1" value="3"> 3 
								<input class="form-check-input" type="radio" name="quest1" value="4"> 4 
								<input class="form-check-input" type="radio" name="quest1" value="5"> 5 
								<span class="question-text"> ... Strongly Agree</span>
							</div>
						</div>
						<div class="form-group question-border question-text alternate-row-highlight">
							<label class="text-info">You like to learn new things.</label>
							<div class="form-check form-check-inline radio-label-text">
								<span class="question-text">Strongly Disagree ... </span>
								<input class="form-check-input" type="radio" name="quest2" value="1"> 1 
								<input class="form-check-input" type="radio" name="quest2" value="2"> 2 
								<input class="form-check-input" type="radio" name="quest2" value="3"> 3 
								<input class="form-check-input" type="radio" name="quest2" value="4"> 4 
								<input class="form-check-input" type="radio" name="quest2" value="5"> 5 
								<span class="question-text"> ... Strongly Agree</span>
							</div>
						</div>
						<div class="form-group question-border question-text alternate-row-highlight">
							<label class="text-info">You are adventurous in your eating.</label>
							<div class="form-check form-check-inline radio-label-text">
								<span class="question-text">Strongly Disagree ... </span>
								<input class="form-check-input" type="radio" name="quest3" value="1"> 1 
								<input class="form-check-input" type="radio" name="quest3" value="2"> 2 
								<input class="form-check-input" type="radio" name="quest3" value="3"> 3 
								<input class="form-check-input" type="radio" name="quest3" value="4"> 4 
								<input class="form-check-input" type="radio" name="quest3" value="5"> 5 
								<span class="question-text"> ... Strongly Agree</span>
							</div>
						</div>
						<div class="form-group question-border question-text alternate-row-highlight">
							<label class="text-info">You feel guilty about things often.</label>
							<div class="form-check form-check-inline radio-label-text">
								<span class="question-text">Strongly Disagree ... </span>
								<input class="form-check-input" type="radio" name="quest4" value="1"> 1 
								<input class="form-check-input" type="radio" name="quest4" value="2"> 2 
								<input class="form-check-input" type="radio" name="quest4" value="3"> 3 
								<input class="form-check-input" type="radio" name="quest4" value="4"> 4 
								<input class="form-check-input" type="radio" name="quest4" value="5"> 5 
								<span class="question-text"> ... Strongly Agree</span>
							</div>
						</div>
						<div class="form-group question-border question-text alternate-row-highlight">
							<label class="text-info">You have a good amount of free time.</label>
							<div class="form-check form-check-inline radio-label-text">
								<span class="question-text">Strongly Disagree ... </span>
								<input class="form-check-input" type="radio" name="quest5" value="1"> 1 
								<input class="form-check-input" type="radio" name="quest5" value="2"> 2 
								<input class="form-check-input" type="radio" name="quest5" value="3"> 3 
								<input class="form-check-input" type="radio" name="quest5" value="4"> 4 
								<input class="form-check-input" type="radio" name="quest5" value="5"> 5 
								<span class="question-text"> ... Strongly Agree</span>
							</div>
						</div>
						<div class="form-group question-border question-text alternate-row-highlight">
							<label class="text-info">You like to throw parties.</label>
							<div class="form-check form-check-inline radio-label-text">
								<span class="question-text">Strongly Disagree ... </span>
								<input class="form-check-input" type="radio" name="quest6" value="1"> 1 
								<input class="form-check-input" type="radio" name="quest6" value="2"> 2 
								<input class="form-check-input" type="radio" name="quest6" value="3"> 3 
								<input class="form-check-input" type="radio" name="quest6" value="4"> 4 
								<input class="form-check-input" type="radio" name="quest6" value="5"> 5 
								<span class="question-text"> ... Strongly Agree</span>
							</div>
						</div>
						<div class="form-group question-border question-text alternate-row-highlight">
							<label class="text-info">You strive for perfection.</label>
							<div class="form-check form-check-inline radio-label-text">
								<span class="question-text">Strongly Disagree ... </span>
								<input class="form-check-input" type="radio" name="quest7" value="1"> 1 
								<input class="form-check-input" type="radio" name="quest7" value="2"> 2 
								<input class="form-check-input" type="radio" name="quest7" value="3"> 3 
								<input class="form-check-input" type="radio" name="quest7" value="4"> 4 
								<input class="form-check-input" type="radio" name="quest7" value="5"> 5 
								<span class="question-text"> ... Strongly Agree</span>
							</div>
						</div>
						<div class="form-group question-border question-text alternate-row-highlight">
							<label class="text-info">You like to be in control.</label>
							<div class="form-check form-check-inline radio-label-text">
								<span class="question-text">Strongly Disagree ... </span>
								<input class="form-check-input" type="radio" name="quest8" value="1"> 1 
								<input class="form-check-input" type="radio" name="quest8" value="2"> 2 
								<input class="form-check-input" type="radio" name="quest8" value="3"> 3 
								<input class="form-check-input" type="radio" name="quest8" value="4"> 4 
								<input class="form-check-input" type="radio" name="quest8" value="5"> 5 
								<span class="question-text"> ... Strongly Agree</span>
							</div>
						</div>
						<div class="form-group question-border question-text alternate-row-highlight">
							<label class="text-info">You are more mature than your peers.</label>
							<div class="form-check form-check-inline radio-label-text">
								<span class="question-text">Strongly Disagree ... </span>
								<input class="form-check-input" type="radio" name="quest9" value="1"> 1 
								<input class="form-check-input" type="radio" name="quest9" value="2"> 2 
								<input class="form-check-input" type="radio" name="quest9" value="3"> 3 
								<input class="form-check-input" type="radio" name="quest9" value="4"> 4 
								<input class="form-check-input" type="radio" name="quest9" value="5"> 5 
								<span class="question-text"> ... Strongly Agree</span>
							</div>
						</div>
						<div class="form-group question-border question-text alternate-row-highlight">
							<label class="text-info">You like listening to others talk about their experiences.</label>
							<div class="form-check form-check-inline radio-label-text">
								<span class="question-text">Strongly Disagree ... </span>
								<input class="form-check-input" type="radio" name="quest10" value="1"> 1 
								<input class="form-check-input" type="radio" name="quest10" value="2"> 2 
								<input class="form-check-input" type="radio" name="quest10" value="3"> 3 
								<input class="form-check-input" type="radio" name="quest10" value="4"> 4 
								<input class="form-check-input" type="radio" name="quest10" value="5"> 5 
								<span class="question-text"> ... Strongly Agree</span>
							</div>
						</div>
						<button class="btn btn-primary btn-large btn-block" id="survey-submit" type="submit" data-toggle="modal" data-target="#err-modal">Submit</button>
					</form>
				</div> <!-- End Panel Body -->
		    </div> <!-- End Panel -->
		</div> <!-- End Panel Group -->

		<hr>
		<a href="/api/friends" id="api-link">View Friends List API</a>  | 
		<a href="https://github.com/abreaw/FriendFinder">GitHub Repo</a>

		<!-- The Modal -->
		<div class="modal fade" id="err-modal">
			<div class="modal-dialog">
		    	<div class="modal-content">
		      
		        <!-- Modal Header -->
		        <div class="modal-header">
		        	<h4 class="modal-title">Eror</h4>
		        	<button type="button" class="close" data-dismiss="modal">&times;</button>
		        </div>
		        
		        <!-- Modal body -->
		        <div class="modal-body">
		        	Please complete all the fields in the survey.
		        </div>
		        
		        <!-- Modal footer -->
		        <div class="modal-footer">
		        	<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
		        </div>
		        
		      </div>  <!-- end modal-content -->
		    </div>  <!-- end modal-dialog -->
		</div>  <!-- end Modal -->

	</div> <!-- End container -->

<script type="text/javascript">

$(document).ready(function(){

	$("#survey-submit").on("click", function() {

		event.preventDefault();
		console.log("submit button clicked take action now");

		clearPrevErrors();

		var userName = $("#name-input").val().trim();
		var imgLink = $("#profile-img-link").val().trim();

		var surveyArray = [];
		var questionNum = 10;

		var isValid = true;

		// var q1Value = $("input[name='quest1']:checked").val();
		// var q2Value = $("input[name='quest2']:checked").val();
		// var q3Value = $("input[name='quest3']:checked").val();
		// var q4Value = $("input[name='quest4']:checked").val();
		// var q5Value = $("input[name='quest5']:checked").val();
		// var q6Value = $("input[name='quest6']:checked").val();
		// var q7Value = $("input[name='quest7']:checked").val();
		// var q8Value = $("input[name='quest8']:checked").val();
		// var q9Value = $("input[name='quest9']:checked").val();
		// var q10Value = $("input[name='quest10']:checked").val();


		// could do this as a $(".form-group").each function(){}
		// as used in the below form-control loop ... would need to get the name of the child for each parent element
		// then check to see if there is a checked value ... if there isn't then assign the error-display class
		// to that parent element and send focus to it too
		for (var i = 1; i <= questionNum; i++) {

			var currAnswer = $("input[name='quest" + i +"']:checked").val()
			
			if (currAnswer != undefined){

				surveyArray.push(parseInt(currAnswer));

			} else {

				isValid = false;

				var blankQuestion = "input[name='quest" + i + "']";
				// var blankQuestParent = $(blankQuestion + ":parent");
				// var blankQuestParent = $(blankQuestion).parents(); // returns all the parents for the blankQuestion input item
				var blankQuestParent = $(blankQuestion).parents(".form-group");

				// console.log("parent element");
				// console.log($(blankQuestParent).attr("class"));
				// console.log(blankQuestParent);
				// console.log("this question is not completed", blankQuestion);

				// adds the error highlight to the form-group so the background color can highlight that it wasn't completed
				$(blankQuestParent).addClass("error-display");
				$(blankQuestParent).focus();

				// maybe add modal handler here too ??

				// console.log("field not completed = ", $(blankQuestion).attr("name"));
			}
			

		}

		// console.log("username = ", userName);
		// console.log("pic link = ", imgLink);
		// console.log("surveyArray = ");
		// console.log(surveyArray);

		$(".form-control").each(function(){

			if ( $(this).val() === "") {
				isValid = false;
				$(this).addClass("error-display");
				$(this).focus();
				// maybe add modal handler here too ??

				console.log("field not completed = ", $(this).attr("id"));

			}

		});


		// var checkRadioInputs = $("input[type=radio]:checked"); // returns all the input radio buttons that are checked
		// // var notcheckedRadioInputs = $("input[type=radio]:not(:checked)"); // returns all the input raido buttons that are not selected

		// if (checkRadioInputs.length != 10) {

		// 	console.log("radio inputs not completed fully");
		// 	// $('#err-modal').modal('show');
		// 	// $("#err-modal").attr("display", "show"); 
		// 	// can't get modal to show up with either line above ... not sure the issue

		// 	alert("Please complete all fields in the survey");

		// 	console.log(checkRadioInputs);
		// 	// console.log(notcheckedRadioInputs);

		// 	isValid = false;

		// }


		// submit data from form if all survey questions answered
		if (isValid) {

			// setup user data object
			var userSurveyInfo = {

				name: userName,
				photo: imgLink,
				scores: surveyArray
			}

			console.log("userSurveyInfo = ");
			console.log(userSurveyInfo);

			
			// send user data object to the server
			$.post("/api/friends", userSurveyInfo, function(data) {

				console.log("----------------------------------------");
				console.log("new friend added", userSurveyInfo);
				console.log("----------------------------------------");

				// $.get("/results", function(data) {

				// 	console.log("get call started for best friend results");
					
					console.log("data back from the post call");
					console.log("---------------------------------------");
					console.log(data);
					console.log("---------------------------------------");
					
					// data should contain the friend information to setup the html page so need to add jquery to put the data into the page once the page is requested
					// how do i make the user go to that location in the url? ... location.??

					/* ... example from the book sequelize project
					// Create a parent div to hold book data
				    var wellSection = $("<div>");
				    // Add a class to this div: 'well'
				    wellSection.addClass("well");
				    // Add an id to the well to mark which well it is
				    wellSection.attr("id", "book-well-" + i);
				    // Append the well to the well section
				    $("#well-section").append(wellSection);
				    */

				// });

				// Clear the form after submitting
				// $("#name-input").val("");
				// $("#profile-img-link").val("");
				// $("input[name^=quest]:checked").val(""); // ^ allows the input name to start with 'quest'

			});


			// if no errors sending object then display friend found


		} else {

			// show an error but this is not working :(
			// $("#err-model").show();
			// $('#err-modal').modal('show');
			// $("#err-modal").attr("display", "show"); 
			// can't get modal to show up with either line above ... not sure the issue

			alert("Please complete all fields in the survey");
		}



	});  // end of submit click function

	function clearPrevErrors() {

		$(".error-display").removeClass("error-display");
	}

});  // end of Document Ready Function


</script>


</body>
</html>